---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { locales, defaultLocale, translations } from "../../i18n/translations.js";

export function getStaticPaths() {
  return locales
    .filter((locale) => locale.code !== defaultLocale)
    .map((locale) => ({ params: { lang: locale.code } }));
}

const { lang } = Astro.params;
const t = translations[lang] ?? translations[defaultLocale];
const basePath = `/${lang}`;
const privacyLabel = t.footer.privacy;
const privacyHref = `${basePath}/privacy`;
---

<BaseLayout title={`Scanium ${t.tos.title}`} description={t.tos.description} lang={lang}>
  <Header
    downloadLabel={t.header.download}
    languageLabel={t.header.languageLabel}
    homeHref={`${basePath}/`}
    downloadHref={`${basePath}/#download`}
  />
  <main id="main" class="mx-auto max-w-4xl px-6 pb-24 pt-24">
    <div class="mb-10">
      <p class="text-xs uppercase tracking-[0.3em] text-text-muted">{t.tos.updated}</p>
      <h1 class="section-title mt-4 text-3xl font-semibold text-white sm:text-4xl">{t.tos.title}</h1>
    </div>

    <div class="space-y-6 text-sm leading-7 text-text-muted">
      {t.tos.sections.map((section) => (
        <section class="rounded-2xl border border-white/10 bg-navy-light/60 p-6">
          <h2 class="text-lg font-semibold text-white">{section.title}</h2>
          {section.items.length === 1 ? (
            <p class="mt-3">
              {section.items[0].split("contact@scanium.app")[0]}
              {section.items[0].includes("contact@scanium.app") ? (
                <a class="text-scanium-cyan" href="mailto:contact@scanium.app">contact@scanium.app</a>
              ) : null}
              {section.items[0].split("contact@scanium.app")[1] ?? ""}
            </p>
          ) : (
            <ol class="mt-3 list-decimal space-y-2 pl-5">
              {section.items.map((item) =>
                item.includes(privacyLabel) ? (
                  <li>
                    {item.split(privacyLabel)[0]}
                    <a class="text-scanium-cyan" href={privacyHref}>{privacyLabel}</a>
                    {item.split(privacyLabel)[1] ?? ""}
                  </li>
                ) : (
                  <li>{item}</li>
                )
              )}
            </ol>
          )}
        </section>
      ))}
    </div>
  </main>
  <Footer
    privacyLabel={t.footer.privacy}
    tosLabel={t.footer.tos}
    copyrightLabel={t.footer.copyright}
    basePath={basePath}
  />
</BaseLayout>
